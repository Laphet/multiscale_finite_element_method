#include "quadrature.h"
/*
    See https://pomax.github.io/bezierinfo/legendre-gauss.html#n20
*/

const int N = 20;

const double WEIGHT[N] = 
[
    0.1527533871307258, 0.1527533871307258, 0.1491729864726037, 0.1491729864726037, 0.1420961093183820, 
    0.1420961093183820, 0.1316886384491766, 0.1316886384491766, 0.1181945319615184, 0.1181945319615184,
    0.1019301198172404, 0.1019301198172404, 0.0832767415767048, 0.0832767415767048, 0.0626720483341091, 
    0.0626720483341091, 0.0406014298003869, 0.0406014298003869, 0.0176140071391521, 0.0176140071391521
];

const double ABSCISSA[N] =
[
    -0.0765265211334973, 0.0765265211334973, -0.2277858511416451, 0.2277858511416451, -0.3737060887154195,
    0.3737060887154195, -0.5108670019508271, 0.5108670019508271, -0.6360536807265150, 0.6360536807265150,
    -0.7463319064601508, 0.7463319064601508, -0.8391169718222188, 0.8391169718222188, -0.9122344282513259,
    0.9122344282513259, -0.9639719272779138, 0.9639719272779138, -0.9931285991850949, 0.9931285991850949
];

double getQuadrature(const FuncWithArg f, const void* arg)
{
    int i, j;
    double quadrature = 0.0;
    for (i = 0, i < N, ++i)
        for (j = 0, j < N, ++j)
        quadrature += WEIGHT[i] * WEIGHT[j] * f(ABSCISSA[i], ABSCISSA[j], arg);
    
    return quadrature;
}